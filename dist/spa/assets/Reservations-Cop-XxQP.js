import{_ as R,G as F,N as p,I as n,L as i,J as a,K as d,t as y,T as m,B as c,W as u,H as v,S as f,aC as b,a7 as C,a0 as L,a6 as V,n as _,Q as N,aj as S,a1 as T,r as B}from"./index-B0iSiuEa.js";import{Q as w}from"./QTooltip-CiG7XDpu.js";import{Q as E}from"./QTd-pFYt8EDs.js";import{T as U,Q as D,e as I}from"./TPagination-gtQN2vqc.js";import{Q as k}from"./QMenu-DeCSquD-.js";import{Q as M}from"./QForm-CVwwJjEb.js";import{C as q}from"./ClosePopup-CMAJ_Ip8.js";import{u as j}from"./use-meta-BaTCs18N.js";import"./rtl-DFPa-2ov.js";import"./format-hlGAdIUH.js";import"./selection-NvJEFU-3.js";import"./QList-B86bEfPj.js";import"./use-fullscreen-tRaayeB4.js";const z=[{name:"id",required:!0,label:"ID",align:"left",field:"id",sortable:!0},{name:"name",required:!0,label:"Name",align:"left",field:"name",sortable:!0},{name:"company",required:!0,label:"Company",align:"left",field:"company",sortable:!0},{name:"email",required:!0,label:"Email",align:"left",field:"email",sortable:!0},{name:"paid",required:!0,label:"Paid",align:"left",field:"paid",sortable:!0},{name:"date",required:!0,label:"Date",align:"left",field:"date",sortable:!0},{name:"selected_space",required:!0,label:"Selected space",align:"left",field:"selected_space",sortable:!0},{name:"actions",required:!0,label:"Actions",align:"left",field:l=>l.id,sortable:!1}];function x(l,t){let o=t!==void 0?t(l):l;return o=o==null?"":String(o),o=o.split('"').join('""'),`"${o}"`}const A={setup(){j({title:"Reservations"})},components:{TPagination:U},data(){const l=B({sortBy:"desc",descending:!1,page:1,rowsPerPage:8});return{columns:z,selected:[],category:null,categories:[],rows:[],errors:[],image:null,pagination:l,filter:"",curl:"",separator:"",mode:"list",role:"fruitbay",items:[],meta:{},links:{},currentPage:1,data:{},loading:!1,editstate:!1,editReserve:!1,editLoad:!1,reserveid:"",spaceid:"",initialPagination:{rowsPerPage:30,pagesNumber:1},loaders:{delete:!1,category:!1,deleteBtn:[],save:[]}}},computed:{pagesNumber(){return Math.ceil(this.rows.length/this.pagination.rowsPerPage)}},mounted(){this.onRequest({pagination:this.pagination,filter:void 0})},methods:{onRequest(l){this.loading=!0;const t="admin/spaces/reservations/pending";this.curl=t,this.$api.get(t).then(o=>{console.log(o),this.loading=!1,this.rows=o.data.data,this.items=o.data.data,this.links=o.data.links,this.meta=o.data.meta}).catch(({response:o})=>{console.log(o),this.loading=!1,this.rows=[]})},EditReservation(l){this.editReserve=!0,this.editstate=!0,console.log(l);let t=l.id,o=l.space_id;this.reserveid=t,this.spaceid=o,this.data.company=l.company,this.data.email=l.email,this.data.name=l.name},editedFunction(l){l.preventDefault();let t=this.spaceid,o=this.reserveid;this.editLoad=!0;let r={status:"paid"};this.$api.put(`admin/spaces/${t}/reservations/${o}/status`,r).then(({data:e})=>{console.log("edited",e),this.refreshPage(),this.editLoad=!1,this.editReserve=!1,this.errors=[]}).catch(({response:e})=>{this.editLoad=!1,console.log(e)})},refreshPage(){this.curl!==""&&(this.loading=!0,this.$api.get(this.curl).then(({data:l})=>{this.loading=!1,this.items=l.data,console.log(l)}).catch(({response:l})=>{console.log(l),this.loading=!1,this.rows=[]}))},exportTable(){const l=[this.columns.map(o=>x(o.label))].concat(this.rows.map(o=>this.columns.map(r=>x(typeof r.field=="function"?r.field(o):o[r.field===void 0?r.name:r.field],r.format)).join(","))).join(`\r
`);I("fruitbay-management.csv",l,"text/csv")!==!0&&this.$q.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})}}},G={class:"q-pt-xl"},W={class:"full-width row flex-center text-negative q-gutter-sm"},H={key:0,class:"text-h6"},J={key:1,class:"text-h6"},K={class:"row q-gutter-sm"},O={class:"col"},X={key:0,class:"error"},Y={class:"col"},Z={key:0,class:"error"},$={class:"row q-gutter-sm"},ee={class:"col"},te={key:0,class:"error"};function le(l,t,o,r,e,g){const Q=F("t-pagination");return n(),p("div",G,[i(D,{title:"Spaces",class:"q-pt-xl",rows:e.items,"hide-header":e.mode==="grid",columns:e.columns,"row-key":"id",grid:e.mode=="grid",filter:e.filter,loading:e.loading,selection:"multiple",selected:e.selected,"onUpdate:selected":t[2]||(t[2]=s=>e.selected=s),pagination:e.initialPagination,onRequest:g.onRequest},{"top-right":a(s=>[i(b,{outlined:"",dense:"",debounce:"300",modelValue:e.filter,"onUpdate:modelValue":t[0]||(t[0]=h=>e.filter=h),placeholder:"Search"},{append:a(()=>[i(y,{name:"search"})]),_:1},8,["modelValue"]),e.mode==="list"?(n(),v(c,{key:0,flat:"",round:"",dense:"",icon:s.inFullscreen?"fullscreen_exit":"fullscreen",onClick:s.toggleFullscreen},{default:a(()=>[i(w,{disable:l.$q.platform.is.mobile},{default:a(()=>[u(m(s.inFullscreen?"Exit Fullscreen":"Toggle Fullscreen"),1)]),_:2},1032,["disable"])]),_:2},1032,["icon","onClick"])):f("",!0),s.inFullscreen?f("",!0):(n(),v(c,{key:1,flat:"",round:"",dense:"",icon:e.mode==="grid"?"list":"grid_on",onClick:t[1]||(t[1]=h=>{e.mode=e.mode==="grid"?"list":"grid",e.separator=e.mode==="grid"?"none":"horizontal"})},{default:a(()=>[i(w,{disable:l.$q.platform.is.mobile},{default:a(()=>[u(m(e.mode==="grid"?"List":"Grid"),1)]),_:1},8,["disable"])]),_:1},8,["icon"])),e.rows.length?(n(),v(c,{key:2,color:"primary","icon-right":"archive",label:"Export to csv","no-caps":"",padding:"xs",onClick:g.exportTable},null,8,["onClick"])):f("",!0)]),"body-cell-actions":a(s=>[i(E,{props:s},{default:a(()=>[d("div",null,[i(c,{round:"",dense:"",glossy:"",color:"info",size:"sm",class:"q-ml-sm",icon:"edit",loading:e.loaders.save[s.value],onClick:h=>g.EditReservation(s.row)},{default:a(()=>[i(w,null,{default:a(()=>[u("Edit "+m(s.row.name),1)]),_:2},1024)]),_:2},1032,["loading","onClick"])])]),_:2},1032,["props"])]),"no-data":a(({icon:s,message:h,filter:P})=>[d("div",W,[i(y,{size:"2em",name:"sentiment_dissatisfied"}),d("span",null," Well this is sad... "+m(h),1),i(y,{size:"2em",name:P?"filter_b_and_w":s},null,8,["name"])])]),_:1},8,["rows","hide-header","columns","grid","filter","loading","selected","pagination","onRequest"]),i(C,{align:"center"},{default:a(()=>[i(Q,{links:e.links,meta:e.meta,container:"#contentContainer",modelValue:e.currentPage,"onUpdate:modelValue":t[3]||(t[3]=s=>e.currentPage=s),onLoading:t[4]||(t[4]=s=>l.loadingMore=!0),onLoaded:t[5]||(t[5]=s=>(e.items=s,l.loadingMore=!1))},null,8,["links","meta","modelValue"])]),_:1}),i(T,{modelValue:e.editReserve,"onUpdate:modelValue":t[9]||(t[9]=s=>e.editReserve=s)},{default:a(()=>[i(L,{style:{width:"800px","max-width":"85vw"}},{default:a(()=>[i(V,null,{default:a(()=>[e.editstate?(n(),p("div",J,[t[11]||(t[11]=u(" Confirm reservation ")),_(i(c,{round:"",flat:"",dense:"",icon:"close",class:"float-right",color:"grey-8"},null,512),[[q]])])):(n(),p("div",H,[t[10]||(t[10]=u(" Add spaces ")),_(i(c,{round:"",flat:"",dense:"",icon:"close",class:"float-right",color:"grey-8"},null,512),[[q]])]))]),_:1}),i(N,{inset:""}),i(V,{class:"q-pt-none"},{default:a(()=>[i(M,{onSubmit:S(g.editedFunction,["prevent"]),class:"q-gutter-md"},{default:a(()=>[d("div",K,[d("div",O,[i(k,{class:"q-pb-xs"},{default:a(()=>t[12]||(t[12]=[u("Name")])),_:1}),i(b,{dense:"",outlined:"",name:"name",modelValue:e.data.name,"onUpdate:modelValue":t[6]||(t[6]=s=>e.data.name=s),label:"Name"},null,8,["modelValue"]),e.errors.name?(n(),p("div",X,m(e.errors.name[0]),1)):f("",!0)]),d("div",Y,[i(k,{class:"q-pb-xs"},{default:a(()=>t[13]||(t[13]=[u("Company")])),_:1}),i(b,{dense:"",outlined:"",name:"company",type:"text",modelValue:e.data.company,"onUpdate:modelValue":t[7]||(t[7]=s=>e.data.company=s),label:"Company"},null,8,["modelValue"]),e.errors.company?(n(),p("div",Z,m(e.errors.company[0]),1)):f("",!0)])]),d("div",$,[d("div",ee,[i(k,{class:"q-pb-xs"},{default:a(()=>t[14]||(t[14]=[u("Email")])),_:1}),i(b,{dense:"",outlined:"",name:"email",modelValue:e.data.email,"onUpdate:modelValue":t[8]||(t[8]=s=>e.data.email=s),label:"Email"},null,8,["modelValue"]),e.errors.email?(n(),p("div",te,m(e.errors.email[0]),1)):f("",!0)])]),i(C,{align:"right",class:"text-teal"},{default:a(()=>[e.editstate?_((n(),v(c,{key:0,label:"Paid",type:"submit",color:"primary",onClick:g.editedFunction,loading:e.editLoad},null,8,["onClick","loading"])),[[q,!1]]):f("",!0)]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const he=R(A,[["render",le],["__scopeId","data-v-4ac7c603"]]);export{he as default};
